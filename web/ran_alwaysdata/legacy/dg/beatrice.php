<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <title>Beatrice</title>
        <link rel="stylesheet" type="text/css" href="web5b.css" />
    </head>
    <body>
    <table width="100%" height="100%"><tr height="10%"><td></td></tr><tr height="80%"><td align="center" valign="center">
        <div class="main">
        <span></span>
        <table class="invisible"><tr><td align="left"><h1>Beatrice</h1><td align="right"><img src="leaf_purple.png" height="60" width="60"/></td></tr></table>
        <div class="menu">- <a class="intext" href="index.php">News</a> | <a class="intext" href="beatrice.php">Beatrice</a> | <a class="intext" href="scriptal.php">Scriptal</a> | <a class="intext" href="ariane.php">Ariane</a> | <a class="intext" href="about.php">À propos</a> -</div>
        <table class="inside">
            <tr>
                <td class="menu">
                    <ul>
                        <li><a class="menu" href="beatrice.php?content=intro">Introduction</a></li>
                        <li><a class="menu" href="beatrice.php?content=prononciation">Prononciation</a></li>
                        <li class="part">Grammaire</li>
                        <li><a class="menu" href="beatrice.php?content=noms_adjs">Noms et adjectifs</a></li>
                        <li><a class="menu" href="beatrice.php?content=articles">Articles</a></li>
                        <li><a class="menu" href="beatrice.php?content=pronoms">Pronoms</a></li>
                        <li><a class="menu" href="beatrice.php?content=adjs_non_q">Adjectifs non qualificatifs</a></li>
                        <li><a class="menu" href="beatrice.php?content=cat_adverbes">Adverbes</a></li>
                        <li><a class="menu" href="beatrice.php?content=prepositions">Prépositions</a></li>
                        <li><a class="menu" href="beatrice.php?content=conjonctions">Conjonctions</a></li>
                        <li><a class="menu" href="beatrice.php?content=verbes">Verbes</a></li>
                        <li><a class="menu" href="beatrice.php?content=negation">La négation</a></li>
                        <li><a class="menu" href="beatrice.php?content=condition">La condition</a></li>
                        <li class="part">Conjugaison</li>
                        <li class="sep">Indicatif</li>
                        <li><a class="menu" href="beatrice.php?content=ind_present">Présent</a></li>
                        <li><a class="menu" href="beatrice.php?content=ind_futur">Futur</a></li>
                        <li><a class="menu" href="beatrice.php?content=ind_imparfait">Imparfait</a></li>
                        <li><a class="menu" href="beatrice.php?content=ind_passe_comp">Passé composé</a></li>
                        <li><a class="menu" href="beatrice.php?content=irreguliers">Verbes irréguliers</a></li>
                        <li><a class="menu" href="beatrice.php?content=subjonctif">Subjonctif</a></li>
                        <li><a class="menu" href="beatrice.php?content=conditionnel">Conditionnel</a></li>
                        <li class="sep">Participe</li>
                        <li><a class="menu" href="beatrice.php?content=par_passe">Passé</a></li>
                        <li class="part">Vocabulaire</li>
                        <li><a class="menu" href="beatrice.php?content=buono_bello">Buono et bello</a></li>
                        <li><a class="menu" href="beatrice.php?content=il_y_a">Il y a</a></li>
                        <li><a class="menu" href="beatrice.php?content=c_est">C'est</a></li>
                        <li><a class="menu" href="beatrice.php?content=frequence">La fréquence</a></li>
                        <li><a class="menu" href="beatrice.php?content=expressions">Expressions</a></li>
                        <li><a class="menu" href="beatrice.php?content=se_deplacer">Se déplacer</a></li>
                        <li><a class="menu" href="beatrice.php?content=heures_dates">Heures et dates</a></li>
                        <li><a class="menu" href="beatrice.php?content=nombres">Les nombres</a></li>
                        <li><a class="menu" href="beatrice.php?content=mathematiques">Mathématiques</a></li>
                        <li><a class="menu" href="beatrice.php?content=voc&cat=pronom_sujet">Pron. Sujet</a></li>
                        <li><a class="menu" href="beatrice.php?content=voc&cat=adverbes">Adverbes</a></li>
                        <li><a class="menu" href="beatrice.php?content=voc&cat=conjonctions">Conjonctions</a></li>
                        <li><a class="menu" href="beatrice.php?content=voc&cat=pays">Pays</a></li>
                        <li><a class="menu" href="beatrice.php?content=voc&cat=couleurs">Couleurs</a></li>
                        <li><a class="menu" href="beatrice.php?content=voc&cat=qualites">Qualités</a></li>
                        <li><a class="menu" href="beatrice.php?content=voc&cat=maison">La maison</a></li>
                        <li><a class="menu" href="beatrice.php?content=voc&cat=saisons">Les saisons</a></li>
                        <li><a class="menu" href="beatrice.php?content=voc&cat=famille">La famille</a></li>
                        <li><a class="menu" href="beatrice.php?content=voc&cat=se_nourrir">Se nourrir</a></li>
                        <li><a class="menu" href="beatrice.php?content=voc&cat=animaux">Les animaux</a></li>
                        <li><a class="menu" href="beatrice.php?content=voc&cat=temps">Jours et mois</a></li>
                        <li><a class="menu" href="beatrice.php?content=voc&cat=voyager">Voyager</a></li>
                        <li><a class="menu" href="beatrice.php?content=voc&cat=corps">Le corps</a></li>
                        <li><a class="menu" href="beatrice.php?content=voc&cat=divers">Divers</a></li>
                        <li class="part">Annexes</li>
                        <li><a class="menu" href="beatrice.php?content=tests">Tests</a></li>
                        <li><a class="menu" href="beatrice.php?content=ressources">Ressources</a></li>
                        <li><a class="menu" href="beatrice.php?content=remerciements">Remerciements</a></li>
                        <li><a class="menu" href="beatrice.php?content=historique">Historique</a></li>
                </td>
                <td class="middle">
                    <?php
                        include "tools.php";
                        
                        $content = 'intro';
                        if (isset($_GET['content']) and check($_GET['content'])) {
                            $content = $_GET['content'];
                        }
                        
                        switch($content) {
                            case "voc":
                                if (isset($_GET['cat']) and check($_GET['cat'])) {
                                    echo '<p class="text">Vocabulaire thématique</p>';
                                    $cat = $_GET['cat'];
                                    $requete = "SELECT count(*) as c FROM w_words WHERE lang = 'it' and tag = '" . $cat ."'";
                                    if ($resultat = get($requete)) {
                                        $arr = mysql_fetch_assoc ($resultat);
                                        echo '<p>' . $arr[c] . ' termes.</p>';
                                    }
                                    $r = get_words($cat, 'it');
                                    if ($r) {
                                        //echo count($r);
                                        $subtag = '';
                                        echo '<table>';
                                        foreach ($r as $word) {
                                            //echo 'AAA';
                                            if ($subtag !== '' and $arr['subtag'] !== $subtag) {
                                                echo '<tr><td>&nbsp;</td><td>&nbsp;</td></tr>';
                                                $subtag = $arr['subtag'];
                                            } else if ($subtag === '') {
                                                $subtag = $arr['subtag'];
                                            }
                                            echo '<tr><td>' . fword_it($word) . '</td><td>' . $word['meaning'] . '</td></tr>';
                                        }
                                        echo '</table>';
                                    } else {
                                        echo("Catégorie inexistante : " . $_GET['cat']);
                                    }
                                }
                                break;
                            case "search":
                                if (isset($_GET['item']) and check($_GET['item'])) {
                                    $item = $_GET['item'];
                                    $r = get_words_by_form($item, 'it');
                                    if (!$r or count($r) == 0) {
                                        echo '<p>Le mot "' . $item . '" n\'a pas été trouvé.</p>';
                                        echo '<p>Voulez-vous le rechercher sur : </p>';
                                        echo '<ul><li><a href="http://www.wordreference.com/iten/'.$item.'">Word Reference (en anglais)</a></li></ul>';
                                    } else {
                                        echo '<table>';
                                        foreach ($r as $word) {
                                            echo '<tr><td>' . fword_it($word) . '</td><td>' . $word['meaning'] . '</td></tr>';
                                        }
                                        echo '</table>';
                                    }
                                }
                                break;
                            case "conjugate":
                                if (isset($_GET['item']) and check($_GET['item'])) {
                                    $item = $_GET['item'];

                                    $requete = "SELECT `form`, `lang`, `mode`, `tense`, `sg1`, `sg2`, `sg3`, `pl1`, `pl2`, `pl3`
                                    FROM w_words_verbs_conjugation
                                    WHERE `form` = '$item'";

                                    $resultat = get($requete);
                                    if (mysql_num_rows($resultat) == 0) {
                                        echo '<p>Le verbe "' . $item . '" n\'a pas été trouvé.</p>';
                                    } else {
                                        echo '<h1>' . ucfirst($item). '</h1>';
                                        while ($arr = mysql_fetch_assoc ($resultat)) {
                                            if (!is_null($arr['sg3'])) { // Participes alors
                                                echo '<p class="text">' . ucfirst($arr['mode']) . " " . ucfirst($arr['tense']) . '</p>';
                                                echo '<table>';
                                                echo '<tr><td>io</td><td>' . $arr['sg1'] .  '</td></tr>';
                                                echo '<tr><td>tu</td><td>' . $arr['sg2'] .  '</td></tr>';
                                                echo '<tr><td>lui, lei</td><td>' . $arr['sg3'] .  '</td></tr>';
                                                echo '<tr><td>voi</td><td>' . $arr['pl1'] .  '</td></tr>';
                                                echo '<tr><td>noi</td><td>' . $arr['pl2'] .  '</td></tr>';
                                                echo '<tr><td>loro</td><td>' . $arr['pl3'] .  '</td></tr>';
                                                echo '</table>';
                                            }  else {
                                                echo '<p class="text">' . ucfirst($arr['mode']) . " " . ucfirst($arr['tense']) . '</p>';
                                                echo '<table>';
                                                echo '<tr><td>' . $arr['sg1'] .  '</td></tr>';
                                                echo '<tr><td>' . $arr['sg2'] .  '</td></tr>';
                                                echo '<tr><td>' . $arr['pl1'] .  '</td></tr>';
                                                echo '<tr><td>' . $arr['pl2'] .  '</td></tr>';
                                                echo '</table>';
                                            }
                                        }
                                    }
                                }
                                break;
                            case "tests":
                                $requete = "SELECT `form`, `class`, `meaning` FROM w_words ORDER BY `form` ASC";
                                $resultat = get($requete);
                                $res = array();
                                while ($arr = mysql_fetch_assoc ($resultat)) {
                                    $res[]=$arr;
                                }
                                $rand_keys = array_rand($res, 10);
                                echo '<table>';
                                $i = 1;
                                foreach ($rand_keys as $key) {
                                    $arr = $res[$key];
                                    echo '<tr><td>'.$i.'</td><td>' .fword_it($arr) . '</td><td>' . $arr['meaning'] . '</td></tr>';
                                    //$input[$rand_keys[0]] . "\n";
                                    $i+=1;
                                }
                                echo '</table>';
                                break;
                            default:
                                $requete = "SELECT id, title, content FROM legacy_chunks WHERE id = '" . $content . "'";
                                if ($resultat = get($requete)) {
                                    $r = mysql_num_rows($resultat);
                                    if ($r == 1) {
                                        $arr = mysql_fetch_assoc ($resultat);
                                        echo "<h3>" . $arr["title"] . "</h3>";
                                        echo $arr["content"];
                                    }
                                }
                                break;
                        }
                    ?>
                </td>
                <td class="left">
                    <div class="invisible" style="border: 1px dotted black; background-color: #F9FAED;">
                        <p class="rubrique">Dictionnaire</p>
                        <div class="invisible" style="text-align: center; padding-top: 3px;">
                            <form action="beatrice.php" method="get">
                                <input name="content" type="hidden" value="search"/>
                                <input name="item" type="text" size="20"/>
                                <input type="submit" value="Rechercher"/>
                            </form> 
                        </div>
                    </div>
                    <br/>
                    <div class="invisible" style="border: 1px dotted black; background-color: #F9FAED;">
                        <p class="rubrique">Conjugaisons</p>
                        <div class="invisible" style="text-align: center; padding-top: 3px;">
                            <form action="beatrice.php" method="get">
                                <input name="content" type="hidden" value="conjugate"/>
                                <input name="item" type="text" size="20"/>
                                <input type="submit" value="Conjuguer"/>
                            </form> 
                        </div>
                    </div>
                    <br/>
                    <div class="invisible" style="border: 1px dotted black; background-color: #F9FAED;">
                        <p class="rubrique">Verbes essentiels</p>
                        <ul class="rubrique">
                            <li><a href="beatrice.php?content=conjugate&item=avere">avere</a></li>
                            <li><a href="beatrice.php?content=conjugate&item=essere">essere</a></li>
                        </ul>
                    </div>
                    <div class="invisible" style="text-align: center;">
                        <br/>
                        <img src="http://upload.wikimedia.org/wikipedia/commons/9/94/Holygrail.jpg" width="300" height="481" alt="Damsel of the sanct grael, 1874">
                    </div>
                </td>
            </tr>
        </table>
        </div>
        <p class="footer">Damien Gouteux, 2012</p>
    </td><tr width="10%"><td></td></tr></table>
    </body>
</html>
